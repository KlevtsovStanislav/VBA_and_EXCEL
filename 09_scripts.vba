Sub BO()
'----------------------------------------------------------------------------------------------------------------------------
'Добавление новой Бизнес-области
'----------------------------------------------------------------------------------------------------------------------------
Set CallerBook = ThisWorkbook
Dim TimeStamp As String
'----------------------------------------------------------------------------------------------------------------------------
Debug.Print "Открытие соединения DSN" & Now()
Dim db As ADODB.Connection
Set db = New ADODB.Connection
db.ConnectionString = "DSN=TD_RDV"
db.Open
db.CommandTimeout = 0
'----------------------------------------------------------------------------------------------------------------------------
'Указатель на номер строки
'----------------------------------------------------------------------------------------------------------------------------
rownumber = 2
'----------------------------------------------------------------------------------------------------------------------------
Do While CallerBook.Worksheets("Добавление БО").Cells(rownumber, 1).Value <> ""
'----------------------------------------------------------------------------------------------------------------------------
'пока нет пустой строки
'----------------------------------------------------------------------------------------------------------------------------
PBDOM_ID = Worksheets("Добавление БО").Cells(rownumber, 1).Value                     'ID БО
PBDOM_NAME = Worksheets("Добавление БО").Cells(rownumber, 2).Value                   'Наименование БО
PBDOM_ID_DESCRIPTION = Worksheets("Добавление БО").Cells(rownumber, 3).Value         'Описание БО
'----------------------------------------------------------------------------------------------------------------------------
If PBDOM_ID <> "" And PBDOM_NAME <> "" Then
'----------------------------------------------------------------------------------------------------------------------------
            SqlCode01 = "INSERT INTO PRD_DB_DMT.PLDM_BDOM (BDOM_ID,BDOM_NAME,BDOM_DESCRIPTION)" & Chr(10) & Chr(13) & _
                "values (" & PBDOM_ID & "," & "'" & PBDOM_NAME & "'" & "," & "'" & PBDOM_ID_DESCRIPTION & "'" & ")"
            db.Execute (SqlCode01)
End If
'----------------------------------------------------------------------------------------------------------------------------
    rownumber = rownumber + 1
'----------------------------------------------------------------------------------------------------------------------------
Loop
'----------------------------------------------------------------------------------------------------------------------------
    Range("A2:D2").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.ClearContents
'----------------------------------------------------------------------------------------------------------------------------
'----------------------------------------------------------------------------------------------------------------------------
db.Close
End Sub

